# CLAUDE.md

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã§ã‚³ãƒ¼ãƒ‰ã‚’æ‰±ã†éš›ã®Claude Code (claude.ai/code) ã¸ã®ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚

## ä¼šè©±ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

- å¸¸ã«æ—¥æœ¬èªã§ä¼šè©±ã™ã‚‹

## ğŸš€ é–‹ç™ºç’°å¢ƒã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å¿…é ˆèµ·å‹•ã‚³ãƒãƒ³ãƒ‰
```bash
# 1. å…¨ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•
docker-compose up -d

# 2. Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆï¼ˆå¿…é ˆï¼‰
docker exec callstatus-app_backend_1 npx prisma generate

# 3. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼
docker exec -it callstatus-app_backend_1 /bin/bash
cd /app && npm run start:dev

# 4. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ï¼ˆåˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰
docker exec -it callstatus-app_frontend_1 /bin/bash
cd /app && npm run dev
```

### åŸºæœ¬ãƒãƒ¼ãƒˆè¨­å®š
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: ãƒãƒ¼ãƒˆ3000
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: ãƒãƒ¼ãƒˆ3002ï¼ˆå¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹ç”¨3003ï¼‰
- PostgreSQL: ãƒãƒ¼ãƒˆ5432

## ğŸ”§ è©³ç´°é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºï¼ˆNext.js 14ï¼‰
```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰
docker exec -it callstatus-app_frontend_1 bash -c "cd /app && npm run dev"

# ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰ãƒ»èµ·å‹•
docker exec callstatus-app_frontend_1 bash -c "cd /app && npm run build"
docker exec callstatus-app_frontend_1 bash -c "cd /app && npm run start"

# ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯
docker exec callstatus-app_frontend_1 bash -c "cd /app && npm run lint"
docker exec callstatus-app_frontend_1 bash -c "cd /app && npx tsc --noEmit"  # TypeScriptå‹ãƒã‚§ãƒƒã‚¯

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ç¢ºèª
curl http://localhost:3000
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºï¼ˆNestJSï¼‰
```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ãƒ»æ¨å¥¨ï¼‰
docker exec -it callstatus-app_backend_1 bash -c "cd /app && npm run start:dev"

# ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰ãƒ»èµ·å‹•
docker exec callstatus-app_backend_1 bash -c "cd /app && npm run build"
docker exec callstatus-app_backend_1 bash -c "cd /app && npm run start:prod"

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆå……å®Ÿã—ãŸãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆï¼‰
docker exec callstatus-app_backend_1 bash -c "cd /app && npm run test"          # å˜ä½“ãƒ†ã‚¹ãƒˆ
docker exec callstatus-app_backend_1 bash -c "cd /app && npm run test:watch"    # ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰
docker exec callstatus-app_backend_1 bash -c "cd /app && npm run test:cov"      # ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ã
docker exec callstatus-app_backend_1 bash -c "cd /app && npm run test:e2e"      # NestJS E2Eãƒ†ã‚¹ãƒˆ

# ã‚³ãƒ¼ãƒ‰å“è³ªãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
docker exec callstatus-app_backend_1 bash -c "cd /app && npm run lint"
docker exec callstatus-app_backend_1 bash -c "cd /app && npm run format"

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ
docker exec callstatus-app_backend_1 bash -c "cd /app && npm run db:seed"       # ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿æŠ•å…¥
docker exec callstatus-app_backend_1 bash -c "cd /app && npm run db:reset"      # DBå®Œå…¨ãƒªã‚»ãƒƒãƒˆ
docker exec callstatus-app_backend_1 bash -c "cd /app && npx prisma generate"   # Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆ
docker exec callstatus-app_backend_1 bash -c "cd /app && npx prisma migrate dev" # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ

# APIæ¥ç¶šãƒ†ã‚¹ãƒˆ
curl http://localhost:3002/api/test
curl http://localhost:3002/api/staff
```

### E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightãƒ»å……å®Ÿã—ãŸãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆï¼‰
```bash
# ã€é‡è¦ã€‘ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå‰ã«å¿…ãšã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•ç¢ºèª
docker-compose up -d
curl http://localhost:3000 && curl http://localhost:3002/api/test

# å…¨E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆ19ãƒ†ã‚¹ãƒˆï¼šåŸºæœ¬8+ãƒ¬ã‚¤ãƒ¤ãƒ¼5+æ”¯æ´6ï¼‰
npm run test

# å€‹åˆ¥ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:basic        # åŸºæœ¬ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆï¼ˆ8ãƒ†ã‚¹ãƒˆï¼‰
npm run test:layers       # 2å±¤ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ†ã‚¹ãƒˆï¼ˆ5ãƒ†ã‚¹ãƒˆï¼‰
npm run test:support      # æ”¯æ´è¨­å®šæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆï¼ˆ6ãƒ†ã‚¹ãƒˆï¼‰

# ãƒ‡ãƒãƒƒã‚°ãƒ»UIä»˜ããƒ†ã‚¹ãƒˆ
npm run test:headed       # ãƒ–ãƒ©ã‚¦ã‚¶è¡¨ç¤ºã§ã®å®Ÿè¡Œ
npm run test:ui           # Playwright UIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

# ãƒ†ã‚¹ãƒˆç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
npm run test:setup        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚·ãƒ¼ãƒ‰å®Ÿè¡Œï¼ˆãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ï¼‰

# ãƒ†ã‚¹ãƒˆçµæœç¢ºèª
open playwright-report/index.html  # HTMLãƒ¬ãƒãƒ¼ãƒˆ
ls test-results/                   # å¤±æ•—ãƒ­ã‚°ãƒ»ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãƒ»å‹•ç”»
```

## ğŸ• æ™‚åˆ»å‡¦ç†å³æ ¼ãƒ«ãƒ¼ãƒ«ï¼ˆå¿…é ˆéµå®ˆï¼‰

1. **å†…éƒ¨æ™‚åˆ»ã¯å®Œå…¨UTC**ï¼šJST ã¯å…¥å‡ºåŠ›å±¤ã§ã®ã¿ä½¿ç”¨
2. **æ–‡å­—åˆ—ã¯ISO-8601 (Zä»˜ã)å›ºå®š**ï¼šãƒŸãƒªç§’ä¸è¦ãªã‚‰ä¸¸ã‚ã¦ã‚‚ã‚ˆã„
3. **æ—¥æ™‚å‹ã¯TZæƒ…å ±ã‚’æŒã¤å‹é¸æŠ**ï¼šTIMESTAMP WITH TIME ZONE ãªã©
4. **å¤‰æ•°ãƒ»ã‚«ãƒ©ãƒ åã¯ *_utc ã«çµ±ä¸€**ï¼š*_jst ç¦æ­¢
5. **UTCâ†’JSTâ†’UTC round-tripãƒ†ã‚¹ãƒˆã‚’ãƒ¦ãƒ‹ãƒƒãƒˆã«è¿½åŠ **

é•åãŒã‚ã‚Œã°ç”Ÿæˆã‚’ä¸­æ­¢ã—ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã™ã“ã¨ã€‚

## ğŸš¨ Gitæ“ä½œæ™‚ã®å¿…é ˆãƒ«ãƒ¼ãƒ«ï¼ˆçµ¶å¯¾éµå®ˆï¼‰

**gitã‚’ä½¿ã£ã¦éå»ã®çŠ¶æ…‹ã«æˆ»ã‚‹éš›ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã‚’å¿…ãšå®Ÿè¡Œã™ã‚‹ã“ã¨:**

1. **å¾©å…ƒå¯¾è±¡ã®æ˜ç¢ºãªèª¬æ˜**
2. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ˜ç¤ºçš„ãªæ‰¿èª**
3. **æ‰¿èªå¾Œã®ã¿ã€gitæ“ä½œã‚’å®Ÿè¡Œ**

**é•åã—ãŸå ´åˆ:** å³åº§ã«ä½œæ¥­ã‚’ä¸­æ­¢ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¬ç½ªã™ã‚‹ã“ã¨ã€‚

## ğŸ—“ï¸ ç¾åœ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçŠ¶æ³

### èªè¨¼ã‚·ã‚¹ãƒ†ãƒ  ã€å®Œäº†ã€‘ âœ…
- **æœŸé–“**: 2025-06-21 ã€œ 2025-06-22
- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç´šã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…å®Œäº†
- **è©³ç´°**: [/docs/projects/authentication-system.md](/docs/projects/authentication-system.md)

### æ—¥æ¬¡ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆå±¥æ­´æ©Ÿèƒ½ ã€å®Œäº†ã€‘ âœ…
- **æœŸé–“**: 2025-06-24
- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: éå»ãƒ‡ãƒ¼ã‚¿é–²è¦§ãƒ»ãƒã‚¹ã‚­ãƒ³ã‚°æ©Ÿèƒ½å®Ÿè£…å®Œäº†
- **è©³ç´°**: [/docs/projects/historical-snapshots.md](/docs/projects/historical-snapshots.md)

### æœˆæ¬¡ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ pending/approval ã‚·ã‚¹ãƒ†ãƒ  ã€Phase 2 å®Œäº†ã€‘ âœ…
- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: Phase 2 å®Œäº†ï¼ˆ2025-06-28ï¼‰- æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«UIæ”¹å–„å®Ÿè£…
- **å®Œäº†é …ç›®**: 
  - Phase 1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€PendingServiceã€CRUD APIã€æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
  - Phase 2: æœˆæ¬¡ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«çµ±ä¸€ã€å€‹äººãƒšãƒ¼ã‚¸æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«çµ±ä¸€
- **è©³ç´°**: [/docs/projects/monthly-planner-pending-system.md](/docs/projects/monthly-planner-pending-system.md)

### 2å±¤ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚·ã‚¹ãƒ†ãƒ  ã€éƒ¨åˆ†å®Œäº†ã€‘
- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: åŸºç›¤å®Œäº†ã€èªè¨¼ã‚·ã‚¹ãƒ†ãƒ å„ªå…ˆã®ãŸã‚ä¸€æ™‚ä¸­æ–­
- **ç›®çš„**: å¥‘ç´„ï¼ˆåŸºæœ¬å‹¤å‹™æ™‚é–“ï¼‰+ å€‹åˆ¥èª¿æ•´ï¼ˆä¾‹å¤–äºˆå®šï¼‰ã®2å±¤ãƒ‡ãƒ¼ã‚¿ç®¡ç†
- **è©³ç´°**: [/docs/architecture/layered-data-system.md](/docs/architecture/layered-data-system.md)

### äººäº‹ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  ã€å®Œäº†ã€‘ âœ…
- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ä¸€æ‹¬ç¤¾å“¡æƒ…å ±ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ»è‡ªå‹•åˆ¤å®šæ©Ÿèƒ½å®Ÿè£…å®Œäº†
- **è©³ç´°**: [/docs/operations/staff-management-system.md](/docs/operations/staff-management-system.md)

## ğŸ—ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**ã‚³ãƒ¼ãƒ«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¢ãƒ—ãƒª** - ã‚¹ã‚¿ãƒƒãƒ•ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†ã¨åœ¨å¸­çŠ¶æ³ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¿½è·¡ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ 

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: Next.js 14 + TypeScript + Tailwind CSS + Socket.IO
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: NestJS + TypeScript + Prisma ORM + PostgreSQL + WebSockets
- **é–‹ç™ºç’°å¢ƒ**: Docker Composeï¼ˆãƒ©ã‚¤ãƒ–ãƒªãƒ­ãƒ¼ãƒ‰å¯¾å¿œï¼‰
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: JWTèªè¨¼ãƒ»æ¨©é™ç®¡ç†ãƒ»ç›£æŸ»ãƒ­ã‚°
- **ãƒ‡ãƒ¼ã‚¿ç®¡ç†**: 2å±¤ãƒ‡ãƒ¼ã‚¿æ§‹é€  + å±¥æ­´ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ + CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆ

### ä¸»è¦æ©Ÿèƒ½
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†ï¼ˆ8:00-21:00ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ï¼‰
- 2å±¤ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆå¥‘ç´„ãƒ»èª¿æ•´ï¼‰
- æ—¥æ¬¡å±¥æ­´ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ»éå»ãƒ‡ãƒ¼ã‚¿é–²è¦§
- äººäº‹ã‚·ã‚¹ãƒ†ãƒ é€£æºãƒ»è‡ªå‹•åˆ¤å®š
- ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºèªè¨¼ãƒ»æ¨©é™ç®¡ç†
- CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½

## ğŸ›ï¸ ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ğŸ¯ æ–°ã—ã„Claude Codeã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å‘ã‘é‡è¦æƒ…å ±

#### ç¾åœ¨ã®èªè¨¼ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³ï¼ˆé‡è¦ï¼‰
```
âŒ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰èªè¨¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«: ç¾åœ¨ç„¡åŠ¹åŒ–ä¸­ï¼ˆapp.module.tsï¼‰
// import { AuthModule } from './auth/auth.module'; // ç„¡åŠ¹åŒ–
âœ… ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰èªè¨¼UI: å®Œå…¨å®Ÿè£…æ¸ˆã¿ï¼ˆAuthProvider.tsxï¼‰
âš ï¸  ãƒ†ã‚¹ãƒˆç”¨èªè¨¼: ç¾åœ¨æœ‰åŠ¹ï¼ˆæœ¬æ ¼èªè¨¼ã®ä»£æ›¿ï¼‰
```

#### ç¾åœ¨ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ãŒæº–å‚™æ¸ˆã¿ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- JWTèªè¨¼Guardãƒ»Decoratorç¾¤ï¼ˆå…¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã§ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆçŠ¶æ…‹ï¼‰
- èªè¨¼APIï¼ˆ/src/auth/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè‡ªä½“ãŒå­˜åœ¨ã—ãªã„ï¼‰
- æ¨©é™ãƒã‚§ãƒƒã‚¯ï¼ˆä¸€æ™‚çš„ã«ã‚¹ã‚­ãƒƒãƒ—ä¸­ï¼‰

#### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è©³ç´°
**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰:**
- **Next.js 14** + TypeScript + Tailwind CSS 
- **socket.io-client** (ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°)
- **react-dnd** (ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—)
- **date-fns** (æ—¥ä»˜å‡¦ç†)
- **recharts** (ã‚°ãƒ©ãƒ•è¡¨ç¤º)
- **next-auth** (èªè¨¼ãƒ»æœªä½¿ç”¨)
- **bcryptjs** (ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥)

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰:**
- **NestJS** + TypeScript + PostgreSQL
- **Prisma ORM** (ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹)
- **@nestjs/websockets** + **socket.io** (WebSocket)
- **@nestjs/schedule** (ã‚¯ãƒ­ãƒ³ã‚¸ãƒ§ãƒ–)
- **bcrypt** + **@nestjs/jwt** (èªè¨¼)
- **multer** (ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰)

**E2Eãƒ†ã‚¹ãƒˆ:**
- **Playwright** (19ãƒ†ã‚¹ãƒˆå®Ÿè£…æ¸ˆã¿)
- **Jest** (NestJS E2Eãƒ†ã‚¹ãƒˆ)

### ã‚³ã‚¢ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åŸå‰‡

#### 1. 2å±¤ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚·ã‚¹ãƒ†ãƒ 
```
ãƒ¬ã‚¤ãƒ¤ãƒ¼1ï¼ˆContractï¼‰: åŸºæœ¬å¥‘ç´„å‹¤å‹™æ™‚é–“
ã€€ã€€ã€€ã€€ã€€ã€€â†“
ãƒ¬ã‚¤ãƒ¤ãƒ¼2ï¼ˆAdjustmentï¼‰: å€‹åˆ¥èª¿æ•´ãƒ»ä¾‹å¤–äºˆå®š
```
- **Contract**: æ›œæ—¥åˆ¥åŸºæœ¬å‹¤å‹™æ™‚é–“ï¼ˆä¾‹ï¼šæœˆ-é‡‘ 9:00-18:00ï¼‰
- **Adjustment**: ä¼‘æš‡ã€æ—©é€€ã€æ®‹æ¥­ãªã©å€‹åˆ¥èª¿æ•´
- **è¡¨ç¤ºçµ±åˆ**: `/api/schedules/unified` ã§2å±¤ãƒ‡ãƒ¼ã‚¿ã‚’çµ±åˆè¡¨ç¤º

#### 2. Pending/Approval ã‚·ã‚¹ãƒ†ãƒ 
```
æœˆæ¬¡ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ â†’ Pendingä½œæˆ â†’ ç®¡ç†è€…æ‰¿èª â†’ Adjustmentã«å¤‰æ›
```
- **PendingSchedule**: æ‰¿èªå¾…ã¡äºˆå®šï¼ˆ`isPending: true`ï¼‰
- **æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹**: ç®¡ç†è€…ã«ã‚ˆã‚‹ä¸€æ‹¬ãƒ»å€‹åˆ¥æ‰¿èª
- **çŠ¶æ…‹ç®¡ç†**: pending â†’ approved â†’ active ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«

#### 3. å±¥æ­´ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆæ©Ÿèƒ½
```
æ—¥æ¬¡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« â†’ Snapshotãƒ†ãƒ¼ãƒ–ãƒ« â†’ éå»ãƒ‡ãƒ¼ã‚¿é–²è¦§
```
- **è‡ªå‹•ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ**: æ¯æ—¥0æ™‚ã«å‰æ—¥ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
- **ãƒã‚¹ã‚­ãƒ³ã‚°å¯¾å¿œ**: éå»ãƒ‡ãƒ¼ã‚¿ã®å€‹äººæƒ…å ±ä¿è­·
- **å±¥æ­´API**: `/api/schedules/unified?date=YYYY-MM-DD` ã§éå»ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### ãƒšãƒ¼ã‚¸æ§‹æˆ
```
/                    - å‡ºç¤¾çŠ¶æ³ï¼ˆFullMainApp.tsxï¼‰
/personal           - å€‹äººã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆPersonalSchedulePage.tsxï¼‰
/monthly-planner    - æœˆæ¬¡ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ï¼ˆpage.tsxï¼‰
/admin/pending-approval - æ‰¿èªç®¡ç†ç”»é¢
```

#### å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ
- **AuthProvider**: èªè¨¼çŠ¶æ…‹ç®¡ç†ãƒ»JWTå‡¦ç†
- **Timelineç³»**: 8:00-21:00ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¡¨ç¤ºã®å…±é€šãƒ­ã‚¸ãƒƒã‚¯
- **Modalç³»**: CRUDæ“ä½œã®çµ±ä¸€UIï¼ˆSchedule/Assignment/Responsibilityï¼‰
- **Utils**: æ™‚åˆ»å¤‰æ›ãƒ»ç¥æ—¥åˆ¤å®šãƒ»è‰²è¨ˆç®—ã®å…±é€šé–¢æ•°

#### æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«çµ±ä¸€è¨­è¨ˆ
å…¨ãƒšãƒ¼ã‚¸ã§çµ±ä¸€ã•ã‚ŒãŸæ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½“é¨“ï¼š
- ä¸Šéƒ¨ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ + ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®åŒæœŸ
- sticky left sidebarï¼ˆã‚¹ã‚¿ãƒƒãƒ•åå›ºå®šï¼‰
- å‡ºç¤¾çŠ¶æ³ãƒ»å€‹äººãƒšãƒ¼ã‚¸ãƒ»æœˆæ¬¡ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã§çµ±ä¸€å®Ÿè£…

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ
```
app.module.ts               - ãƒ¡ã‚¤ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”œâ”€â”€ schedules/              - ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«CRUDãƒ»WebSocket
â”œâ”€â”€ staff/                  - ã‚¹ã‚¿ãƒƒãƒ•ç®¡ç†
â”œâ”€â”€ pending/                - Pendingäºˆå®šç®¡ç†
â”œâ”€â”€ csv-import/             - CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
â”œâ”€â”€ snapshots/              - å±¥æ­´ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
â”œâ”€â”€ daily-assignments/      - æ”¯æ´è¨­å®š
â”œâ”€â”€ responsibilities/       - æ‹…å½“è¨­å®š
â”œâ”€â”€ department-settings/    - éƒ¨ç½²ãƒ»ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®š
â””â”€â”€ contracts/              - å¥‘ç´„å‹¤å‹™æ™‚é–“
```

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã®è¦ç‚¹
- **Adjustment**: pendingé–¢é€£ã‚«ãƒ©ãƒ ï¼ˆ`isPending`, `approvedBy`, `approvedAt`ï¼‰
- **Contract**: æ›œæ—¥åˆ¥å‹¤å‹™æ™‚é–“ã‚«ãƒ©ãƒ ï¼ˆ`mondayHours`ã€œ`sundayHours`ï¼‰
- **Snapshot**: å±¥æ­´ä¿å­˜ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«
- **PendingApprovalLog**: æ‰¿èªãƒ»å´ä¸‹å±¥æ­´
- **ä¸€æ„åˆ¶ç´„**: é‡è¤‡äºˆå®šé˜²æ­¢ã®åˆ¶ç´„è¨­è¨ˆ

#### APIè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³
- **çµ±åˆAPI**: `/api/schedules/unified` - 2å±¤ãƒ‡ãƒ¼ã‚¿çµ±åˆå–å¾—
- **Pending API**: `/api/schedules/pending/*` - æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
- **å±¥æ­´API**: æ—¥ä»˜æŒ‡å®šã§ã®éå»ãƒ‡ãƒ¼ã‚¿å–å¾—
- **WebSocket**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°é€šçŸ¥

### é‡è¦ãªè¨­è¨ˆæ±ºå®š

#### æ™‚åˆ»å‡¦ç†ã®çµ±ä¸€ãƒ«ãƒ¼ãƒ«
- å†…éƒ¨å‡¦ç†ã¯å®Œå…¨UTCã€å…¥å‡ºåŠ›å±¤ã®ã¿JSTå¤‰æ›
- ISO-8601å½¢å¼ï¼ˆZä»˜ãï¼‰ã§ã®æ–‡å­—åˆ—å‡¦ç†
- ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³æƒ…å ±ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å‹ã®ä½¿ç”¨

#### ç¥æ—¥å¯¾å¿œã‚·ã‚¹ãƒ†ãƒ 
- å¥‘ç´„ãƒ‡ãƒ¼ã‚¿ã®ç¥æ—¥ç„¡åŠ¹åŒ–ï¼ˆç¥æ—¥ã¯å¥‘ç´„å‹¤å‹™ãªã—ï¼‰
- ç¥æ—¥åˆ¤å®šã«ã‚ˆã‚‹æ—¥ä»˜è¡¨ç¤ºã®èµ¤å­—åŒ–
- å…¨ãƒšãƒ¼ã‚¸æ¨ªæ–­ã§ã®ä¸€è²«ã—ãŸç¥æ—¥å‡¦ç†

#### æ¨©é™ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ
- JWTèªè¨¼ã«ã‚ˆã‚‹ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- ç®¡ç†è€…ãƒ»ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ¨©é™åˆ†é›¢
- Pendingæ“ä½œã§ã®æ¨©é™ãƒã‚§ãƒƒã‚¯ï¼ˆç¾åœ¨ã¯ä¸€æ™‚ç„¡åŠ¹åŒ–ï¼‰

## ğŸ“š è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰
- [èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ](/docs/projects/authentication-system.md)
- [å±¥æ­´ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ](/docs/projects/historical-snapshots.md)
- [æœˆæ¬¡ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼](/docs/projects/monthly-planner-pending-system.md)

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- [2å±¤ãƒ‡ãƒ¼ã‚¿ã‚·ã‚¹ãƒ†ãƒ ](/docs/architecture/layered-data-system.md)

### é‹ç”¨ãƒ»ç®¡ç†
- [äººäº‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ](/docs/operations/staff-management-system.md)

### é–‹ç™ºãƒ»ä¿å®ˆ
- [æ™‚åˆ»å‡¦ç†ãƒ«ãƒ¼ãƒ«](/docs/development/time-handling-rules.md)
- [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](/docs/development/troubleshooting.md)

## ğŸš¨ ç·Šæ€¥æ™‚ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### æœ€é‡è¦ï¼šå¿…é ˆé–‹ç™ºã‚³ãƒãƒ³ãƒ‰
```bash
# 1. å…¨ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•ï¼ˆæœ€åˆã«å¿…ãšå®Ÿè¡Œï¼‰
docker-compose up -d

# 2. Prismaã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆï¼ˆå¿…é ˆãƒ»å¿˜ã‚ŒãŒã¡ï¼‰
docker exec callstatus-app_backend_1 npx prisma generate

# 3. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
docker exec -it callstatus-app_backend_1 /bin/bash
cd /app && npm run start:dev

# 4. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆåˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰
docker exec -it callstatus-app_frontend_1 /bin/bash
cd /app && npm run dev
```

### ã‚ˆãã‚ã‚‹å•é¡Œã®å³åº§è§£æ±º
```bash
1. Prismaã‚¨ãƒ©ãƒ¼ â†’ docker exec callstatus-app_backend_1 npx prisma generate
2. ãƒ—ãƒ­ã‚»ã‚¹æ®‹å­˜ â†’ docker restart callstatus-app_backend_1
3. ãƒ¡ãƒ¢ãƒªä¸è¶³ â†’ free -h ã§ç¢ºèªã€Dockerå†èµ·å‹•
4. ãƒãƒ¼ãƒˆç«¶åˆ â†’ lsof -i :3000 -i :3002 ã§ç¢ºèª
5. APIæ¥ç¶šå¤±æ•— â†’ curl http://localhost:3002/api/test
```

### ãƒ—ãƒ­ã‚»ã‚¹ç«¶åˆé˜²æ­¢ï¼ˆé‡è¦ï¼‰
```bash
# ãƒ—ãƒ­ã‚»ã‚¹ç¢ºèª
docker exec callstatus-app_backend_1 ps aux | grep node

# å…¨åœæ­¢
docker exec callstatus-app_backend_1 pkill -f "nest|node"

# æœ€çµ‚æ‰‹æ®µï¼šã‚¯ãƒªãƒ¼ãƒ³ãƒªã‚»ãƒƒãƒˆ
docker restart callstatus-app_backend_1
```

### ç’°å¢ƒè¨­å®šå•é¡Œ
- **config.ini** ã¨ **frontend/public/config.js** ã®ä¸¡æ–¹å¤‰æ›´å¿…é ˆ
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠå†èµ·å‹•å¾Œã«ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ï¼ˆCtrl+F5ï¼‰

### è‡ªå‹•ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«å¾©æ—§
```bash
# Next.jsãƒ“ãƒ«ãƒ‰æˆæœç‰©å‰Šé™¤æ™‚
docker restart callstatus-app_frontend_1
docker exec -d callstatus-app_frontend_1 bash -c "cd /app && rm -rf .next && npm run dev"

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰æˆæœç‰©å‰Šé™¤æ™‚  
docker restart callstatus-app_backend_1
docker exec callstatus-app_backend_1 bash -c "cd /app && npm run build"
```

**è©³ç´°**: [å®Œå…¨ç‰ˆãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰](/docs/development/troubleshooting.md)

## ğŸ“‹ é‡è¦ãªæŒ‡ç¤ºãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼

- æ±‚ã‚ã‚‰ã‚ŒãŸã“ã¨ã‚’è¡Œã†ã€‚ãã‚Œä»¥ä¸Šã§ã‚‚ä»¥ä¸‹ã§ã‚‚ãªã„
- ç›®æ¨™é”æˆã«çµ¶å¯¾å¿…è¦ã§ãªã„é™ã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ãªã„
- æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã‚ˆã‚Šã‚‚ã€æ—¢å­˜ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã™ã‚‹ã“ã¨ã‚’å¸¸ã«å„ªå…ˆã™ã‚‹
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ*.mdï¼‰ã‚„READMEãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç©æ¥µçš„ã«ä½œæˆã—ãªã„

---

**ğŸ“ æ›´æ–°å±¥æ­´**
- 2025-06-28: æœˆæ¬¡ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼Phase 2å®Œäº†ã€æ–°Claude Codeå‘ã‘æŠ€è¡“è©³ç´°ãƒ»èªè¨¼çŠ¶æ³ãƒ»é–‹ç™ºã‚³ãƒãƒ³ãƒ‰å¼·åŒ–
- 2025-06-26: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåˆ†å‰²ãƒ»æ§‹é€ åŒ–ã«ã‚ˆã‚‹ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆåŒ–å®Ÿæ–½
- è©³ç´°æƒ…å ±ã¯å„å°‚ç”¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§